<!-- templates/agent_detail.html -->
{% extends 'base.html' %}

{% block body %}
  <div class="agent-detail-container">
    <h1 class="agent-detail-title">Détails de l'agent : {{ agent.name }}</h1>

    <div class="agent-info">
      <p>
        <strong>État :</strong>
        <span class="agent-status">
          <span class="{% if agent.enabled == 1 %}active-title{% else %}inactive-title{% endif %}">
            {{ 'Actif' if agent.enabled == 1 else 'Inactif' }}
          </span>
        </span>
      </p>
      <p><strong>Dernier scan :</strong> {{ agent.last_scan }}</p>
      <p><strong>Prochain scan prévu :</strong> {{ agent.next_scan }}</p>
    </div>

    <h2>Configuration de l'agent</h2>
    <form action="{{ url_for('agent', agent_id=agent.id_agent) }}" method="post" class="agent-config-form">
      <div class="form-group">
        <label for="next_scan">Prochain scan (jour et heure) :</label>
        <input type="datetime-local" id="next_scan" name="next_scan" value="{% if agent.next_scan_date_ %}{{ agent.next_scan_date_.strftime('%Y-%m-%dT%H:%M') }}{% else %}{% endif %}" required>
      </div>
      <div class="form-group">
        <label for="enabled">Activer l'agent :</label>
        <input type="checkbox" id="enabled" name="enabled" {% if agent.enabled %}checked{% endif %}>
      </div>
      <button type="submit" class="btn btn-primary">Enregistrer</button>
    </form>

    {% if success %}
      <p class="config-success">Configuration mise à jour avec succès.</p>
    {% endif %}
    {% if error %}
      <p class="config-error">{{ error }}</p>
    {% endif %}
  </div>
{% endblock %}